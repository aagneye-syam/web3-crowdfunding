#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const node_child_process_1 = require("node:child_process");
const cross_spawn_1 = require("cross-spawn");
const generate_js_1 = require("./commands/generate/generate.js");
// skip the first two args?
const [, , command = "", ...rest] = process.argv;
async function main() {
    switch (command) {
        case "generate": {
            const [chainIdPlusContract] = rest;
            if (!(0, generate_js_1.isValidChainIdAndContractAddress)(chainIdPlusContract)) {
                console.info("Usage: thirdweb generate <chainId>/<contractAddress>");
                process.exit(1);
            }
            else {
                await (0, generate_js_1.generate)(chainIdPlusContract);
            }
            break;
        }
        default: {
            const isWindows = /^win/.test(process.platform);
            const isBunAvailable = (() => {
                try {
                    const res = (0, node_child_process_1.execSync)("bun --version", {
                        stdio: "ignore",
                        encoding: "utf-8",
                    });
                    if (typeof res === "string" && res.indexOf(".") > -1) {
                        return true;
                    }
                }
                catch { }
                return false;
            })();
            let runner = "npx";
            switch (true) {
                case isBunAvailable:
                    runner = "bun";
                    break;
                case isWindows:
                    runner = "npx.cmd";
                    break;
            }
            const args = command
                ? ["--yes", "@thirdweb-dev/cli@latest", command, ...rest]
                : ["--yes", "@thirdweb-dev/cli@latest", ...rest];
            (0, cross_spawn_1.spawn)(runner, args, {
                stdio: "inherit",
            });
        }
    }
}
main();
//# sourceMappingURL=bin.js.map