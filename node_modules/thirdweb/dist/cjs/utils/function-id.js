"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getFunctionId = void 0;
const sha256_1 = require("@noble/hashes/sha256");
const hex_js_1 = require("./encoding/hex.js");
// WeakMap should be fine, if we de-reference the function, it should be garbage collected
const functionIdCache = new WeakMap();
/**
 * Retrieves the unique identifier for a given function.
 * If the function has been previously cached, the cached identifier is returned.
 * Otherwise, a new identifier is generated using the function's string representation.
 * @param fn - The function for which to retrieve the identifier.
 * @returns The unique identifier for the function.
 * @internal
 */
function getFunctionId(fn) {
    if (functionIdCache.has(fn)) {
        // biome-ignore lint/style/noNonNullAssertion: the `has` above ensures that this will always be set
        return functionIdCache.get(fn);
    }
    const id = (0, hex_js_1.uint8ArrayToHex)((0, sha256_1.sha256)(fn.toString()));
    functionIdCache.set(fn, id);
    return id;
}
exports.getFunctionId = getFunctionId;
//# sourceMappingURL=function-id.js.map